---
output: github_document
bibliography: inst/ref.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# extreme random forest
<!-- badges: start -->
[![R build status](https://github.com/nicolagnecco/erf/workflows/R-CMD-check/badge.svg)](https://github.com/nicolagnecco/erf/actions)
<!-- badges: end -->

The goal of erf is to predict extreme quantiles within the quantile forest framework of @athe2019 [https://doi.org/10.1214/18-AOS1709].

## Installation

<!-- You can install the released version of erf from [CRAN](https://CRAN.R-project.org) with: -->

``` r
install.packages("erf")
```

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("nicolagnecco/erf")
```
## Example

This is a basic example which shows you how to peform prediction with `erf`.
Let us create some datasets and fit a `quantile_forest` from the `grf` package.

```{r example1}
library(erf)
library(grf)
set.seed(42)

n <- 500
p <- 10
X <- matrix(rnorm(n * p), n, p)
Y <- X[, 1] * rnorm(n)
object <- quantile_forest(X, Y, quantiles = c(0.1, 0.5, 0.9))

```

Now we can create a test dataset and predict extreme quantiles with `predict_erf`.

```{r example2}
n_test <- 20
X.test <-  matrix(rnorm(n_test * p), n_test, p)
Y.test <- X.test[, 1] * rnorm(n_test)

quantiles <- c(.99, .999)
threshold <- 0.8

res <- predict_erf(object, quantiles = quantiles, threshold = threshold,
                   newdata = X.test, model_assessment = TRUE,
                   Y.test = Y.test, out_of_bag = FALSE)

head(res$predictions)
res$plot
```

## References
